#!/usr/bin/env bash
# Apache log analyzer - groups by IP and HTTP status without forbidden commands

awk '
BEGIN {
    print "OCCURENCE_NUMBER IP HTTP_CODE"
}
{
    # Count each IP+status combination
    counts[$1,$9]++
}
END {
    # Process and sort the results
    PROCINFO["sorted_in"] = "@val_num_desc"
    for (key in counts) {
        split(key, parts, SUBSEP)
        print counts[key], parts[1], parts[2]
    }
}' "$1"
